(this.webpackJsonpbattleship=this.webpackJsonpbattleship||[]).push([[0],{26:function(e,t,a){},27:function(e,t,a){},37:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a(1),i=a.n(n),s=a(19),l=a.n(s),c=(a(26),a(7)),o=(a(27),a(9)),u=a(2),d=a.p+"static/media/battleship_background.506e93d5.jpg",h=function(){return Object(r.jsxs)("div",{className:"hero",children:[Object(r.jsx)("header",{children:Object(r.jsx)("h1",{className:"logo",children:"Battleship"})}),Object(r.jsx)("img",{className:"background",src:d,alt:""}),Object(r.jsxs)("div",{className:"text",children:[Object(r.jsx)("h2",{children:"Control the seas"}),Object(r.jsx)("p",{children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat."}),Object(r.jsx)(o.b,{to:"/play",children:Object(r.jsx)("button",{children:"Play now"})})]})]})},p=function(e){return Object(r.jsxs)("header",{className:"header",children:[Object(r.jsxs)("div",{className:"header-text",children:[Object(r.jsx)(o.b,{to:"/",children:Object(r.jsx)("h1",{className:"header-link",children:"Battleship"})}),Object(r.jsx)(o.b,{to:"/",children:Object(r.jsx)("button",{className:"newGameBtn",onClick:function(){},children:"New game"})})]}),Object(r.jsx)("img",{className:"background",src:d,alt:""})]})},m=function(){return Object(r.jsxs)("div",{className:"footer",children:[Object(r.jsx)("span",{children:"Built by Owen Kraft.\u2002"}),Object(r.jsx)("a",{href:"https://forms.gle/U9p64oQHRci6q6rr5",target:"_blank",rel:"noreferrer",children:" Report a bug here."})]})},f=a(8),g=a(18),j=a.n(g),b=function(e,t){var a=e,r=t,n=s(r);function i(){return n.reduce((function(e,t){return e+t}),0)}function s(e){return Object(f.a)(new Array(e)).map((function(e){return 0}))}return{name:a,length:r,sunk:!1,hitArray:n,resetShip:function(){this.sunk=!1,this.hitArray=s(r)},hit:function(e){n[e]=1,i()===n.length&&!1===this.sunk&&(this.sunk=!0)},checkNumOfHits:i}},v=[{admiral:"Horatio Nelson"},{admiral:"Grigori Potemkin"},{admiral:"T\u014dg\u014d Heihachir\u014d"},{admiral:"Hayreddin Barbarossa"},{admiral:"Francis Drake"},{admiral:"Chester Nimitz"},{admiral:"Yi Sun-sin"}],y=function(e){function t(e){var t=e.target.closest(".cell");return{cell:t,x:Number(t.attributes[1].value),y:Number(t.attributes[2].value)}}function a(e,t){return document.querySelectorAll('[data-agent="player"][data-row="'.concat(e,'"]'))[t]}function r(e,t,a){var r=e.firstElementChild,n=t[0],i=t[2],s=t[3];if(!1===n)r.querySelector(".miss-icon").classList.remove("hidden"),r.parentElement.classList.add("miss");else if(!0===n){r.querySelector(".hit-icon").classList.remove("hidden"),r.parentElement.classList.add("hit");var l=a[i];l.hit(s),console.log("ship sunk?",l.sunk)}return n}return{getAdmiral:function(){var e=Math.floor(Math.random()*Math.floor(v.length));return v[e].admiral},displayShipPreview:function(e,t,r,n){var i=t.length,s=n.gameboard,l=e.x,c=e.y,o="Click a cell to place ship",u=o,d=n.checkForValidShipPlacement(l,c,i,r);if(!1!==d.validPlacement){if("vertical"===r)for(var h=c;h<c+i;h++){u=o,a(l,h).classList.add("placeShip")}else if("horizontal"===r)for(var p=l;p<l+i;p++){u=o,a(p,c).classList.add("placeShip")}}else if(!1===d.validPlacement){if("vertical"===r)if(c+i>s[0].length)for(var m=c;m<s[0].length;m++){u="invalid placement! ship length extends past gameboard",a(l,m).classList.add("placeShip-invalid")}else for(var f=c;f<c+i;f++){u="invalid placement! one or more coordinates already occupied",a(l,f).classList.add("placeShip-invalid")}else if("horizontal"===r)if(l+i>s[0].length)for(var g=l;g<s[0].length;g++){u=o,a(g,c).classList.add("placeShip-invalid")}else for(var j=l;j<l+i;j++){u="invalid placement! one or more coordinates already occupied",a(j,c).classList.add("placeShip-invalid")}}else u="invalid orientation! orientation must be either 'horizontal' or 'vertical'";return u},displayPlayerShip:function(e){e.forEach((function(e){a(e[0],e[1]).classList.add("playerShip")}))},clickCompCell:function(e,a,n){var i=t(e),s=a.checkHit(i.x,i.y);return r(i.cell,s,n)},removeShipFromSelector:function(e,t){for(var a=[],r=0;r<t.options.length;r++)a[r]=t.options[r].value;var n=a.findIndex((function(t){return t===e}));t.remove(n),0===t.options.length&&document.querySelector(".ship-selector").classList.add("hidden")},createShips:function(){return{carrier:b("carrier",5),battleship:b("battleship",4),cruiser:b("cruiser",3),submarine:b("submarine",3),destroyer:b("destroyer",2)}},getCoordinates:t,getCell:a,checkIfAllShipsSunk:function(e){var t=Object.getOwnPropertyNames(e),a=[];return t.forEach((function(t){a.push(e[t].sunk)})),a.filter((function(e){return!0===e})).length===t.length},displayCellClickResult:r,updateInfoPanel:function(e){var t=document.querySelector(".info-panel");t.classList.remove("info-panel-success"),t.classList.remove("info-panel-warning"),t.classList.remove("info-panel-danger"),"success"===e?t.classList.add("info-panel-success"):"warning"===e?t.classList.add("info-panel-warning"):"danger"===e&&t.classList.add("info-panel-danger")}}},O=function(e){var t=y(),a=e.agent,n=e.board,i=e.ships,s=e.gameState;return Object(r.jsx)("div",{className:"cell ".concat(e.agent),"data-row":e.row,"data-column":e.column,"data-agent":e.agent,onClick:function(r){return function(r){var l=i[document.getElementById("ship-dropdown").value],c=document.getElementById("orientation-dropdown").value;if("player"===a&&"setup"===s){var o=t.getCoordinates(r),u=n.placeShip(l,[o.x,o.y],c);if(t.displayPlayerShip(u),0!==u.length){var d=document.getElementById("ship-dropdown");t.removeShipFromSelector(l.name,d),d.options.length||(e.updateGameState("player turn"),t.updateInfoPanel("success"),e.updateMessage("Your fleet has been positioned. Make the first attack!"))}}else if("computer"===a&&"player turn"===s){var h,p=t.clickCompCell(r,n,i);"already clicked"===p?(document.querySelector(".info-panel").classList.add("info-panel-warning"),e.updateMessage("Try another square.")):(e.updateGame(n,i),!0===t.checkIfAllShipsSunk(i)?(e.updateGameState("game over"),t.updateInfoPanel("success"),e.updateMessage("You won! To play again, click 'New Game' in the upper right hand corner.")):(!1===p?(h="Miss! ",t.updateInfoPanel()):!0===p&&(h="Hit! ",t.updateInfoPanel("success")),e.updateMessage(h+e.compName+" is thinking..."),e.updateGameState("comp turn")))}}(r)},onMouseOver:function(e){return function(e){if("player"===a&&"setup"===s){var r=i[document.getElementById("ship-dropdown").value],l=document.getElementById("orientation-dropdown").value,c=t.getCoordinates(e);t.displayShipPreview(c,r,l,n)}else"computer"===a&&"setup"===s?e.target.classList.add("invalid"):"computer"===a&&"setup"!==s&&"game over"!==s&&(e.target.closest(".cell").classList.contains("hit")||e.target.closest(".cell").classList.contains("miss")?e.target.closest(".cell").classList.add("invalid"):e.target.closest(".cell").classList.contains("hit")&&e.target.closest(".cell").classList.contains("miss")||e.target.closest(".cell").classList.add("valid"))}(e)},onMouseOut:function(t){return function(t){"player"===e.agent&&"setup"===s?document.querySelectorAll(".placeShip, .placeShip-invalid").forEach((function(e){return e.classList.remove("placeShip","placeShip-invalid")})):"computer"===a&&"setup"===s?t.target.classList.remove("invalid"):"computer"===a&&"setup"!==s&&"game over"!==s&&(t.target.closest(".cell").classList.remove("valid"),t.target.closest(".cell").classList.remove("invalid"))}(t)},children:Object(r.jsxs)("div",{children:[Object(r.jsx)(j.a,{symbol:"\ud83d\udd25",label:"hit",className:"emoji hit-icon hidden"}),Object(r.jsx)(j.a,{symbol:"\u2716\ufe0f",label:"miss",className:"emoji miss-icon hidden"})]})})},x=function(e){var t=-1,a=Object(f.a)(new Array(e.gridSize||8)).map((function(a){return Object(r.jsx)(O,{row:e.row,column:t+=1,agent:e.agent,board:e.board,ships:e.ships,compName:e.compName,gameState:e.gameState,updateGame:e.updateGame,updateGameState:e.updateGameState,updateMessage:e.updateMessage,whenCellClicked:e.whenCellClicked},t)}));return Object(r.jsx)("div",{className:"row",children:a})},S=function(e){var t=-1,a=Object(f.a)(new Array(e.gridSize||8)).map((function(a){return Object(r.jsx)(x,{gridSize:e.gridSize,row:t+=1,agent:e.agent,board:e.board,ships:e.ships,compName:e.compName,gameState:e.gameState,updateGame:e.updateGame,updateGameState:e.updateGameState,updateMessage:e.updateMessage,whenCellClicked:e.whenCellClicked},t)}));return Object(r.jsx)("div",{className:"grid",children:a})},w=function(e,t){e.placeShip(t.carrier,[1,1],"horizontal"),e.placeShip(t.battleship,[6,3],"vertical"),e.placeShip(t.cruiser,[2,3],"horizontal"),e.placeShip(t.submarine,[1,5],"vertical"),e.placeShip(t.destroyer,[6,0],"horizontal")},k=function(){return Object(r.jsxs)("div",{className:"ship-selector",children:[Object(r.jsx)("h3",{className:"ship-selector-text",children:"Change ship or orientation"}),Object(r.jsxs)("div",{children:[Object(r.jsxs)("select",{id:"ship-dropdown",children:[Object(r.jsx)("option",{value:"carrier",children:"Carrier"}),Object(r.jsx)("option",{value:"battleship",children:"Battleship"}),Object(r.jsx)("option",{value:"cruiser",children:"Cruiser"}),Object(r.jsx)("option",{value:"submarine",children:"Submarine"}),Object(r.jsx)("option",{value:"destroyer",children:"Destroyer"})]}),Object(r.jsxs)("select",{id:"orientation-dropdown",children:[Object(r.jsx)("option",{value:"vertical",children:"Vertical"}),Object(r.jsx)("option",{value:"horizontal",children:"Horizontal"})]})]})]})},N=function(e){var t,a,n=y();return"computer"===e.agent?(w(e.board,e.ships),t=e.compName+"'s"):(t="Your",a=Object(r.jsx)(k,{})),Object(r.jsxs)("div",{className:"gameboard",children:[Object(r.jsxs)("h2",{children:[t," board"]}),Object(r.jsx)(S,{gridSize:8,agent:e.agent,board:e.board,ships:e.ships,compName:e.compName,gameState:e.gameState,updateGame:e.updateGame,updateGameState:e.updateGameState,updateMessage:e.updateMessage,whenCellClicked:n.whenCellClicked}),a]})},A=function(){var e=Object(f.a)(new Array(8)).map((function(e){return Object(f.a)(new Array(8)).map((function(e){return["empty"]}))}));function t(t,a,r,n){var i,s;if("vertical"===n)if(a+r>e[0].length)i=!1,s="invalid placement! ship length extends past gameboard";else for(var l=a;l<a+r;l++)"empty"!==e[t][l][0]&&(i=!1,s="invalid placement! one or more coordinates already occupied");else if("horizontal"===n)if(t+r>e.length)i=!1,s="invalid placement! ship length extends past gameboard";else for(var c=t;c<t+r;c++)"empty"!==e[c][a][0]&&(i=!1,s="invalid placement! one or more coordinates already occupied");else i=!1,s="invalid orientation! orientation must be either 'horizontal' or 'vertical'";return{validPlacement:i,message:s}}return{test:function(){console.log("this is a test",e)},gameboard:e,checkForValidShipPlacement:t,placeShip:function(a,r,n){var i=a.name,s=a.length,l=r[0],c=r[1],o=0,u=[];if(!1!==t(l,c,s,n).validPlacement)if("vertical"===n)for(var d=c;d<c+s;d++)e[l][d]=["ship",i,o],u.push([l,d]),o++;else if("horizontal"===n)for(var h=l;h<l+s;h++)e[h][c]=["ship",i,o],u.push([h,c]),o++;return u},checkHit:function(t,a){var r=e[t];return"empty"!==r[a][0]&&"ship"!==r[a][0]?["already clicked"]:"empty"===r[a][0]?(r[a][0]="miss",[!1,"miss"]):"ship"===r[a][0]?(r[a][0]="hit",[!0,"hit",r[a][1],r[a][2]]):void 0}}},C=function(e){var t=e.message;return Object(r.jsx)("div",{className:"info-panel",children:t})},L=function(e,t,a,r){var n=a,i=n.mode;console.log(i);var s=e.gameboard,l=y(),c=["up","down","left","right"],o=function(e){return Math.floor(Math.random()*Math.floor(e))},u=function(e,t){var a,r,n;if("random"===e)for(a=o(s.length),r=o(s[a].length);"miss"===s[a][r][0]||"hit"===s[a][r][0];)a=o(s.length),r=o(s[a].length);else if("hit"===e)if(null===t.direction)do{n=b(t.resultsArray[0].coords).direction;var i=j(t.resultsArray[0].coords,n);a=i.x,r=i.y}while(!O([a,r]));else if("hit"===t.resultsArray[t.resultsArray.length-1].result){n=t.direction;var l=j(t.resultsArray[t.resultsArray.length-1].coords,n);if(a=l.x,r=l.y,!O([a,r])&&(n=v(t.direction),l=j(t.resultsArray[0].coords,n),a=l.x,r=l.y,!O([a,r])))for(n=null,a=o(s.length),r=o(s[a].length);"miss"===s[a][r][0]||"hit"===s[a][r][0];)a=o(s.length),r=o(s[a].length)}else if("miss"===t.resultsArray[t.resultsArray.length-1].result){var c;if(1===t.resultsArray.filter((function(e){return"hit"===e.result})).length&&t.resultsArray.length<5)do{n=b([a,r]),c=j(t.resultsArray[0].coords,n),a=c.x,r=c.y}while(!O([a,r]));else if(n=v(t.direction),c=j(t.resultsArray[0].coords,n),a=c.x,r=c.y,!O([a,r]))for(n=null,a=o(s.length),r=o(s[a].length);"miss"===s[a][r][0]||"hit"===s[a][r][0];)a=o(s.length),r=o(s[a].length)}return{x:a,y:r,direction:n}}(i,n),d=u.x,h=u.y,p=u.direction,m=l.getCell(d,h),f=e.checkHit(d,h),g=l.displayCellClickResult(m,f,t);function j(e,t){var a=e[0],r=e[1];return"up"===t?r-=1:"down"===t?r+=1:"left"===t?a-=1:"right"===t&&(a+=1),{x:a,y:r}}function b(e){return{direction:e===[0,0]||e===[0,7]||e===[7,0]||e===[7,7]?function(e){var t;e===[0,0]?t=Math.random()>=.5?"right":"down":e===[7,7]?t=Math.random()>=.5?"left":"up":e===[7,0]?t=Math.random()>=.5?"left":"down":e===[7,7]&&(t=Math.random()>=.5?"right":"up");return t}(e):0===e[0]||7===e[0]||0===e[1]||7===e[1]?function(e){var t,a=e[0],r=e[1];0===a?t=["up","down","right"][o(2)]:7===a?t=["up","down","left"][o(2)]:0===r?t=["left","right","down"][o(2)]:7===r&&(t=["left","right","up"][o(2)]);return t}(e):c[o(4)]}}function v(e){return"up"===e?"down":"down"===e?"up":"left"===e?"right":"right"===e?"left":void 0}function O(e){var t=e[0],a=e[1];return"miss"!==s[t][a][0]&&"hit"!==s[t][a][0]&&!(t>=s.length||a>=s[t].length||t<0||a<0)}return r(function(e){var t=e;if(console.log("clickResult = ",g),g)null===t.resultsArray?(t.resultsArray=[{result:"hit",coords:[d,h]}],t.mode="hit"):(t.resultsArray.push({result:"hit",coords:[d,h]}),t.direction=p,null===t.direction&&(t.mode="random"));else if(null!==t.resultsArray){var a=t.resultsArray.filter((function(e){return"miss"===e.result})),r=t.resultsArray.filter((function(e){return"hit"===e.result}));a.length>=2&&r.length>1?(t.mode="random",t.resultsArray=null,t.direction=null):t.resultsArray.push({result:"miss",coords:[d,h]})}return console.log(t),t}(n)),g},M=function(e){var t=y(),a=Object(n.useState)("setup"),i=Object(c.a)(a,2),s=i[0],l=i[1],o=Object(n.useState)(A()),u=Object(c.a)(o,2),d=u[0],h=u[1],f=Object(n.useState)(t.createShips()),g=Object(c.a)(f,2),j=g[0],b=g[1],v=Object(n.useState)(t.getAdmiral()),O=Object(c.a)(v,2),x=O[0],S=(O[1],Object(n.useState)(A())),w=Object(c.a)(S,2),k=w[0],M=w[1],G=Object(n.useState)(t.createShips()),P=Object(c.a)(G,2),I=P[0],z=P[1],q=Object(n.useState)({mode:"random",resultsArray:null,direction:null}),B=Object(c.a)(q,2),E=B[0],H=B[1],Y=Object(n.useState)("Place your fleet on your board!"),F=Object(c.a)(Y,2),R=F[0],T=F[1],V=function(e){H(e)},D=function(e){l(e),"comp turn"===e?function(){var e=Math.floor(Math.random()*Math.floor(2e3));setTimeout((function(){var e,a=L(d,j,E,V);!1===a?(e=" missed! ",t.updateInfoPanel()):!0===a&&(e=" hit your ship! ",t.updateInfoPanel("danger")),T(x+e+"Your turn.")}),e),t.checkIfAllShipsSunk(j)?(_(),T("Oh no! Your enemy has sunk all of your ships! To play again, click 'New Game' in the upper right hand corner."),t.updateInfoPanel("danger")):l("player turn")}():"game over"===e&&_()},J=function(e){T(e)},U=function(e,t,a){"player"===e?(h(t),b(a)):"computer"===e&&(M(t),z(a))};function _(){"game over"!==s&&l("game over"),document.querySelector(".newGameBtn").classList.add("btn-inverse")}return Object(r.jsxs)("div",{children:[Object(r.jsx)(p,{resetGame:e.resetGame}),Object(r.jsxs)("div",{className:"playing-area",children:[Object(r.jsx)(C,{message:R}),Object(r.jsx)(N,{agent:"player",board:d,ships:j,gameState:s,updateGame:U,updateGameState:D,updateMessage:J}),Object(r.jsx)(N,{agent:"computer",compName:x,board:k,ships:I,gameState:s,updateGame:U,updateGameState:D,updateMessage:J})]}),Object(r.jsx)(m,{})]})};var G=function(){var e=Object(n.useState)(!1),t=Object(c.a)(e,2),a=t[0],i=t[1];return Object(r.jsx)("div",{children:Object(r.jsx)(o.a,{basename:"/battleship",children:Object(r.jsxs)(u.c,{children:[Object(r.jsx)(u.a,{path:"/",exact:!0,render:function(e){return Object(r.jsx)(h,{})}}),Object(r.jsx)(u.a,{path:"/start",exact:!0,render:function(e){return Object(r.jsx)(h,{})}}),Object(r.jsx)(u.a,{path:"/play",render:function(e){return Object(r.jsx)(M,{game:a,resetGame:i})}})]})})})};l.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(G,{})}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.648a4eca.chunk.js.map